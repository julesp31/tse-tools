from free_busy_times import *
from oit_slots import *
from times_comparer import *
from scheduled_times import *
from printing_oits import *


def main(athena_query):

    # Getting Busy and OIT Times from Athena Query
    # print()
    busy_slots = get_busy_list(athena_query)
    # print()
    oit_slots = get_oit_list(athena_query)
    # print()
    scheduled_slots = get_scheduled_list(athena_query)
    # print()
    available_oits = split_days(oit_slots, busy_slots, scheduled_slots)
    # print()
    printing_times = merge_excess_times(available_oits)
    # print()

    for start, end in printing_times.items():
        print(f"{start} -> {end}")

    return printing_times


main(str({'free_busy_data': [{'End': {'DateTime': '2024-11-20T15:00:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-11-20T14:00:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-11-20T17:00:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-11-20T15:30:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-11-20T21:15:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-11-20T20:30:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-11-22T15:30:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-11-22T15:00:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-11-22T19:00:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-11-22T17:00:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-11-22T20:00:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-11-22T19:30:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-11-22T19:45:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'free', 'Start': {'DateTime': '2024-11-22T19:30:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-11-22T20:30:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-11-22T20:00:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-11-22T21:15:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-11-22T20:30:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-11-22T23:00:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-11-22T21:00:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-11-25T15:30:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-11-25T15:00:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-11-25T17:30:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-11-25T16:00:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-11-25T19:00:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-11-25T17:30:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-11-25T19:30:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-11-25T19:00:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-11-25T20:00:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-11-25T19:30:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-11-25T20:30:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-11-25T20:00:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-11-25T21:15:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-11-25T20:30:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-11-25T22:00:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-11-25T21:30:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-11-26T21:00:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-11-26T20:30:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-11-27T21:15:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-11-27T20:30:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-11-29T05:15:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-11-28T10:45:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-11-30T05:15:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-11-29T09:15:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-11-29T15:30:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'free', 'Start': {'DateTime': '2024-11-29T15:00:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-11-29T21:15:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-11-29T20:30:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-11-29T23:00:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-11-29T21:00:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-12-02T14:30:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-12-02T14:00:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-12-02T15:30:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-12-02T15:00:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-12-02T17:30:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-12-02T17:00:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-12-02T23:00:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-12-02T20:00:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-12-02T21:15:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-12-02T20:30:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-12-03T01:40:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-12-02T23:05:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-12-03T18:30:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-12-03T13:30:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-12-03T20:00:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-12-03T18:30:00.0000000', 'TimeZone': 'UTC'}}, {'End': {'DateTime': '2024-12-03T22:00:00.0000000', 'TimeZone': 'UTC'}, 'IsAllDay': False, 'ShowAs': 'busy', 'Start': {'DateTime': '2024-12-03T19:30:00.0000000', 'TimeZone': 'UTC'}}], 'internal_busy_times': [], 'native_cal_data': {'busy_times': [], 'oits': [{'end': '2024-11-20T18:00:00Z', 'group_ids': '', 'group_ids_list': [], 'job_requisition_ids': {'ats_job_ids': [], 'client_job_ids': []}, 'jobloc_ids': '', 'jobloc_ids_list': [], 'oit_number': 1, 'oit_types': '8,1,2,5', 'oit_types_list': [1, 2, 5, 8], 'priority': False, 'start': '2024-11-20T15:00:00Z', 'user_id': 2170506}, {'end': '2024-11-20T23:00:00Z', 'group_ids': '', 'group_ids_list': [], 'job_requisition_ids': {'ats_job_ids': [], 'client_job_ids': []}, 'jobloc_ids': '', 'jobloc_ids_list': [], 'oit_number': 1, 'oit_types': '8,1,2,5', 'oit_types_list': [1, 2, 5, 8], 'priority': False, 'start': '2024-11-20T19:00:00Z', 'user_id': 2170506}, {'end': '2024-11-21T18:00:00Z', 'group_ids': '', 'group_ids_list': [], 'job_requisition_ids': {'ats_job_ids': [], 'client_job_ids': []}, 'jobloc_ids': '', 'jobloc_ids_list': [], 'oit_number': 1, 'oit_types': '8,1,2,5', 'oit_types_list': [1, 2, 5, 8], 'priority': False, 'start': '2024-11-21T15:00:00Z', 'user_id': 2170506}, {'end': '2024-11-21T23:00:00Z', 'group_ids': '', 'group_ids_list': [], 'job_requisition_ids': {'ats_job_ids': [], 'client_job_ids': []}, 'jobloc_ids': '', 'jobloc_ids_list': [], 'oit_number': 1, 'oit_types': '8,1,2,5', 'oit_types_list': [1, 2, 5, 8], 'priority': False, 'start': '2024-11-21T19:00:00Z', 'user_id': 2170506}, {'end': '2024-11-22T18:00:00Z', 'group_ids': '', 'group_ids_list': [], 'job_requisition_ids': {'ats_job_ids': [], 'client_job_ids': []}, 'jobloc_ids': '', 'jobloc_ids_list': [], 'oit_number': 1, 'oit_types': '8,1,2,5', 'oit_types_list': [1, 2, 5, 8], 'priority': False, 'start': '2024-11-22T15:00:00Z', 'user_id': 2170506}, {'end': '2024-11-22T23:00:00Z', 'group_ids': '', 'group_ids_list': [], 'job_requisition_ids': {'ats_job_ids': [], 'client_job_ids': []}, 'jobloc_ids': '', 'jobloc_ids_list': [], 'oit_number': 1, 'oit_types': '8,1,2,5', 'oit_types_list': [1, 2, 5, 8], 'priority': False, 'start': '2024-11-22T19:00:00Z', 'user_id': 2170506}, {'end': '2024-11-25T18:00:00Z', 'group_ids': '', 'group_ids_list': [], 'job_requisition_ids': {'ats_job_ids': [], 'client_job_ids': []}, 'jobloc_ids': '', 'jobloc_ids_list': [], 'oit_number': 1, 'oit_types': '8,1,2,5', 'oit_types_list': [1, 2, 5, 8], 'priority': False, 'start': '2024-11-25T15:00:00Z', 'user_id': 2170506}, {'end': '2024-11-25T23:00:00Z', 'group_ids': '', 'group_ids_list': [], 'job_requisition_ids': {'ats_job_ids': [], 'client_job_ids': []}, 'jobloc_ids': '', 'jobloc_ids_list': [], 'oit_number': 1, 'oit_types': '8,1,2,5', 'oit_types_list': [1, 2, 5, 8], 'priority': False, 'start': '2024-11-25T19:00:00Z', 'user_id': 2170506}, {'end': '2024-11-26T18:00:00Z', 'group_ids': '', 'group_ids_list': [], 'job_requisition_ids': {'ats_job_ids': [], 'client_job_ids': []}, 'jobloc_ids': '', 'jobloc_ids_list': [], 'oit_number': 1, 'oit_types': '8,1,2,5', 'oit_types_list': [1, 2, 5, 8], 'priority': False, 'start': '2024-11-26T15:00:00Z', 'user_id': 2170506}, {'end': '2024-11-26T23:00:00Z', 'group_ids': '', 'group_ids_list': [], 'job_requisition_ids': {'ats_job_ids': [], 'client_job_ids': []}, 'jobloc_ids': '', 'jobloc_ids_list': [], 'oit_number': 1, 'oit_types': '8,1,2,5', 'oit_types_list': [1, 2, 5, 8], 'priority': False, 'start': '2024-11-26T19:00:00Z', 'user_id': 2170506}, {'end': '2024-11-27T18:00:00Z', 'group_ids': '', 'group_ids_list': [], 'job_requisition_ids': {'ats_job_ids': [], 'client_job_ids': []}, 'jobloc_ids': '', 'jobloc_ids_list': [], 'oit_number': 1, 'oit_types': '8,1,2,5', 'oit_types_list': [1, 2, 5, 8], 'priority': False, 'start': '2024-11-27T15:00:00Z', 'user_id': 2170506}, {'end': '2024-11-27T23:00:00Z', 'group_ids': '', 'group_ids_list': [], 'job_requisition_ids': {'ats_job_ids': [], 'client_job_ids': []}, 'jobloc_ids': '', 'jobloc_ids_list': [], 'oit_number': 1, 'oit_types': '8,1,2,5', 'oit_types_list': [1, 2, 5, 8], 'priority': False, 'start': '2024-11-27T19:00:00Z', 'user_id': 2170506}, {'end': '2024-11-28T18:00:00Z', 'group_ids': '', 'group_ids_list': [], 'job_requisition_ids': {'ats_job_ids': [], 'client_job_ids': []}, 'jobloc_ids': '', 'jobloc_ids_list': [], 'oit_number': 1, 'oit_types': '8,1,2,5', 'oit_types_list': [1, 2, 5, 8], 'priority': False, 'start': '2024-11-28T15:00:00Z', 'user_id': 2170506}, {'end': '2024-11-28T23:00:00Z', 'group_ids': '', 'group_ids_list': [], 'job_requisition_ids': {'ats_job_ids': [], 'client_job_ids': []}, 'jobloc_ids': '', 'jobloc_ids_list': [], 'oit_number': 1, 'oit_types': '8,1,2,5', 'oit_types_list': [1, 2, 5, 8], 'priority': False, 'start': '2024-11-28T19:00:00Z', 'user_id': 2170506}, {'end': '2024-11-29T18:00:00Z', 'group_ids': '', 'group_ids_list': [], 'job_requisition_ids': {'ats_job_ids': [], 'client_job_ids': []}, 'jobloc_ids': '', 'jobloc_ids_list': [], 'oit_number': 1, 'oit_types': '8,1,2,5', 'oit_types_list': [1, 2, 5, 8], 'priority': False, 'start': '2024-11-29T15:00:00Z', 'user_id': 2170506}, {'end': '2024-11-29T23:00:00Z', 'group_ids': '', 'group_ids_list': [], 'job_requisition_ids': {'ats_job_ids': [], 'client_job_ids': []}, 'jobloc_ids': '', 'jobloc_ids_list': [], 'oit_number': 1, 'oit_types': '8,1,2,5', 'oit_types_list': [1, 2, 5, 8], 'priority': False, 'start': '2024-11-29T19:00:00Z', 'user_id': 2170506}, {'end': '2024-12-02T18:00:00Z', 'group_ids': '', 'group_ids_list': [], 'job_requisition_ids': {'ats_job_ids': [], 'client_job_ids': []}, 'jobloc_ids': '', 'jobloc_ids_list': [], 'oit_number': 1, 'oit_types': '8,1,2,5', 'oit_types_list': [1, 2, 5, 8], 'priority': False, 'start': '2024-12-02T15:00:00Z', 'user_id': 2170506}, {'end': '2024-12-02T23:00:00Z', 'group_ids': '', 'group_ids_list': [], 'job_requisition_ids': {'ats_job_ids': [], 'client_job_ids': []}, 'jobloc_ids': '', 'jobloc_ids_list': [], 'oit_number': 1, 'oit_types': '8,1,2,5', 'oit_types_list': [1, 2, 5, 8], 'priority': False, 'start': '2024-12-02T19:00:00Z', 'user_id': 2170506}, {'end': '2024-12-03T18:00:00Z', 'group_ids': '', 'group_ids_list': [], 'job_requisition_ids': {'ats_job_ids': [], 'client_job_ids': []}, 'jobloc_ids': '', 'jobloc_ids_list': [], 'oit_number': 1, 'oit_types': '8,1,2,5', 'oit_types_list': [1, 2, 5, 8], 'priority': False, 'start': '2024-12-03T15:00:00Z', 'user_id': 2170506}, {'end': '2024-12-03T21:02:00Z', 'group_ids': '', 'group_ids_list': [], 'job_requisition_ids': {'ats_job_ids': [], 'client_job_ids': []}, 'jobloc_ids': '', 'jobloc_ids_list': [], 'oit_number': 1, 'oit_types': '8,1,2,5', 'oit_types_list': [1, 2, 5, 8], 'priority': False, 'start': '2024-12-03T19:00:00Z', 'user_id': 2170506}]}, 'scheduled_times': [{'end': '2024-11-19T21:30:00Z', 'itv_start_time_control_type': 1, 'lead_ids': [183924055], 'start': '2024-11-19T21:00:00Z', 'user_id': 2170506}, {'end': '2024-11-19T23:00:00Z', 'itv_start_time_control_type': 1, 'lead_ids': [184386976], 'start': '2024-11-19T22:30:00Z', 'user_id': 2170506}, {'end': '2024-11-22T20:00:00Z', 'itv_start_time_control_type': 1, 'lead_ids': [182586181], 'start': '2024-11-22T19:30:00Z', 'user_id': 2170506}, {'end': '2024-11-22T20:30:00Z', 'itv_start_time_control_type': 1, 'lead_ids': [182029782], 'start': '2024-11-22T20:00:00Z', 'user_id': 2170506}, {'end': '2024-11-25T19:30:00Z', 'itv_start_time_control_type': 1, 'lead_ids': [183857545], 'start': '2024-11-25T19:00:00Z', 'user_id': 2170506}, {'end': '2024-11-25T20:00:00Z', 'itv_start_time_control_type': 1, 'lead_ids': [184272983], 'start': '2024-11-25T19:30:00Z', 'user_id': 2170506}, {'end': '2024-11-25T22:00:00Z', 'itv_start_time_control_type': 1, 'lead_ids': [183757442], 'start': '2024-11-25T21:30:00Z', 'user_id': 2170506}, {'end': '2024-11-26T21:00:00Z', 'itv_start_time_control_type': 1, 'lead_ids': [185028688], 'start': '2024-11-26T20:30:00Z', 'user_id': 2170506}], 'sub_itv_order': None}))
